"use strict";(self.webpackChunkorderapp=self.webpackChunkorderapp||[]).push([[884],{4884:(Ie,y,l)=>{l.r(y),l.d(y,{OrderappOrderFeaturePageComponent:()=>w,orderRoutes:()=>$e});var u=l(2200),a=l(142),m=l(4915),_=l(8610),F=l(3974),j=l(1074),h=l(9115),V=l(3841),x=l(2021),g=l(4731),S=l(3691),k=l(9055),e=l(3664),d=l(2615),v=l(9640),$=l(7589);function X(o,n){if(1&o){const i=e.RV6();e.rj2(0,"div",1),e.VwU("click",function(){const r=d.eBV(i),s=e.XpG(2);return d.Njj(s.addNewItemsToTheOrder(r))}),e.EFF(1," ADD "),e.eux()}}function B(o,n){if(1&o&&(e.nVh(0,X,2,0,"div",0),e.nI1(1,"async")),2&o){let i;const t=e.XpG();e.vxM((i=e.bMT(1,1,t.selectSignedUser$))?0:-1,i)}}let R=(()=>{var o;class n{constructor(t,r,s){this.store=t,this.dialog=r,this.router=s,this.selectSignedUser$=this.store.select(g.Y6)}get canNewItemBeAddedToOrder(){return!!this.order&&(this.order.orderStatus==m.Re.INPROGRESS||this.order.orderStatus==m.Re.PLACED)}addNewItemsToTheOrder(t){if(!this.canUserAddNewOrder(t))return;const r=this.order;if(!r.customer)return;this.store.dispatch((0,k.sX)()),this.store.dispatch((0,a.loadOrderDetails)({orderId:r.id}));const s=r.customer;this.store.dispatch((0,k.hc)({user:{firstName:s.firstName,lastName:s.lastName,userType:r.orderType==m.ut.TABLE?m.ut.TABLE:m.ut.TAKEAWAY},tableId:r.tableId?r.tableId:0,customerId:s?s.id:0,existingOrderId:r.id})),this.dialog.closeAll(),this.router.navigate(["shell/home"])}canUserAddNewOrder(t){return!(!t.isCashier&&this.order.createdUserId!==t.id)}static#e=o=()=>(this.\u0275fac=function(r){return new(r||n)(e.rXU(v.il),e.rXU(_.h),e.rXU($.Ix))},this.\u0275cmp=e.VBU({type:n,selectors:[["hotel-orderapp-order-feature-add-more-item-button"]],inputs:{order:"order"},decls:1,vars:1,consts:[[1,"inline-block","bg-pink-700","px-2","py-1","rounded-md","text-right","cursor-pointer","text-white"],[1,"inline-block","bg-pink-700","px-2","py-1","rounded-md","text-right","cursor-pointer","text-white",3,"click"]],template:function(r,s){1&r&&e.nVh(0,B,2,3),2&r&&e.vxM(s.canNewItemBeAddedToOrder?0:-1)},dependencies:[u.MD,u.Jj],encapsulation:2}))}return o(),n})();var G=l(8919),p=l(9417),I=l(7605);const P=()=>[.5,1,5,10,20,50];function A(o,n){if(1&o){const i=e.RV6();e.j41(0,"button",24),e.bIt("click",function(){const r=d.eBV(i).$implicit,s=e.XpG(2).$index,c=e.XpG();return d.Njj(c.changeNoteClick(r,s))}),e.j41(1,"div",25),e.EFF(2),e.nI1(3,"decimalpointpipe"),e.k0s()()}if(2&o){const i=n.$implicit;e.R7$(2),e.SpI(" ",e.bMT(3,1,i)," ")}}function L(o,n){1&o&&(e.j41(0,"div",22),e.Z7z(1,A,4,3,"button",23,e.fX1),e.k0s()),2&o&&(e.R7$(),e.Dyx(e.lJ4(0,P)))}function U(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",12)(1,"div",16)(2,"div",17)(3,"div",18)(4,"input",19),e.bIt("click",function(r){const s=d.eBV(i).$index,c=e.XpG();return d.Njj(c.payOptionSelection(s,r))}),e.k0s(),e.j41(5,"div",20)(6,"label"),e.EFF(7),e.k0s()(),e.nrm(8,"input",21),e.k0s()(),e.nVh(9,L,3,1,"div",22),e.k0s()()}if(2&o){const i=n.$implicit;e.Y8G("formGroupName",n.$index),e.R7$(7),e.JRh(i.value.name),e.R7$(2),e.vxM("Cash"===i.value.name?9:-1)}}let Y=(()=>{var o;class n{constructor(t,r,s,c){this._fb=t,this.decimalPipe=r,this.store=s,this.dialog=c,this.selectOrderDetailsOfSelectedOrder$=this.store.select(a.selectOrderDetailsOfSelectedOrder),this.selectPaymentTerms$=this.store.select(I.F3),this.order=null,this.billTotal=30.2,this.paymentModes=["Cash","Card","Transfer"],this.shouldPrintBillControl=new p.MJ(!0),this.shouldApplyDiscountControl=new p.MJ(!1),this.discountAppliedControl=new p.MJ(0),this.payForm=this._fb.group({modes:this._fb.array([])}),this.paymentTypeSubscription$=this.selectPaymentTerms$.subscribe(C=>{C.forEach(O=>{this.payForm.get("modes").push(this._fb.group({name:O.name,isSelected:new p.MJ(!1),paymentTypeId:O.id,amount:new p.MJ({value:0,disabled:!0})}))})}),this.orderSubscription$=this.selectOrderDetailsOfSelectedOrder$.subscribe(C=>{C&&(this.order=C,this.billTotal=C.taxedTotal??C.totalAmount)})}get modes(){return this.payForm.controls.modes}isTotalMatchTheBillTotal(){return this.getPaymentEntryTotal()>=this.billTotal}getPaymentEntryTotal(){return this.payForm.value&&this.payForm.value.modes?this.payForm.value.modes.filter(s=>1==s.isSelected).reduce((s,c)=>Number.parseFloat(c.amount)+s,0):0}get balance(){let t=this.billTotal-this.getPaymentEntryTotal();return this.shouldApplyDiscountControl.value&&(t-=this.discountAppliedControl.value),t<0?Math.abs(t):0}payOptionSelection(t,r){if(!r.target.checked)return this.modes.at(t).get("amount").setValue(0),void this.modes.at(t).get("amount").disable();const c=this.shouldApplyDiscountControl?this.discountAppliedControl.value:0,O=this.modes.getRawValue().filter(f=>1==f.isSelected),Re=O.reduce((f,T)=>f+T.amount,0);if(0==O.length){const f=Math.round(1e3*this.billTotal)/1e3;this.modes.at(t).get("amount").setValue(f)}else{const f=this.billTotal-Re-c,T=Math.round(100*f)/100;f>0&&this.modes.at(t).get("amount").setValue(T)}this.modes.at(t).get("amount").enable()}get isFormValid(){const t=this.billTotal-(1==this.shouldApplyDiscountControl.value?this.discountAppliedControl.value:0);return this.getPaymentEntryTotal()>=Math.floor(100*t)/100}changeNoteClick(t,r){if(0==this.modes.at(r).get("isSelected").value)return;if(!this.cashAmountInput(r).touched)return this.cashAmountInput(r).setValue(t),void this.cashAmountInput(r).markAsTouched();const s=this.cashAmountInput(r).value?parseFloat(this.cashAmountInput(r).value):0;this.cashAmountInput(r).setValue(s+t)}cashAmountInput(t){return this.modes.at(t).get("amount")}submitPayment(){if(!this.order&&!this.order.id)return;const t=!!this.shouldPrintBillControl.value,r=this.shouldApplyDiscountControl.value&&this.discountAppliedControl.value||0;this.store.dispatch((0,I.cq)({orderId:this.order.id,orderTotal:this.billTotal,payments:[...this.modes.value.filter(s=>1==s.isSelected)],discount:r,shouldPrintBill:t}))}ngOnDestroy(){this.paymentTypeSubscription$.unsubscribe(),this.orderSubscription$.unsubscribe()}static#e=o=()=>(this.\u0275fac=function(r){return new(r||n)(e.rXU(p.ok),e.rXU(F.Yy),e.rXU(v.il),e.rXU(_.h))},this.\u0275cmp=e.VBU({type:n,selectors:[["lib-payment-mode-list"]],features:[e.Jv_([F.Yy])],decls:29,vars:11,consts:[[1,"bg-white","p-2","rounded-md"],[1,"flex","divide-x"],[1,"h-16","p-4","text-sm","sm:text-xl","w-1/3"],[1,"h-16","p-4","pr-6","text-green-500","flex","items-center","justify-center","w-1/3"],[1,"flex","gap-2","items-center","justify-center"],["type","checkbox","name","include","id","1",1,"sm:h-8","sm:w-8","h-4","w-4",3,"formControl"],[1,"text-xs","text-neutral-500"],["type","number",1,"bg-transparent","text-lg","w-24","sm:w-32","border","pl-2",3,"formControl"],[1,"rounded-full","rounded-l-none","h-16","p-4","pr-6","text-green-500","flex","items-center","justify-center","w-1/3"],[1,"text-lg"],[3,"formGroup"],["formArrayName","modes"],[3,"formGroupName"],[1,"text-right","p-2","mt-2","flex"],["type","checkbox",1,"mr-4","h-10","w-10","accent-pink-500",3,"formControl"],[1,"py-2","px-3","text-center","rounded-md","flex-grow","sm:w-min","bg-green-500","text-white","disabled:bg-gray-300",3,"click","disabled"],[1,"mt-2"],[1,"text-sm","sm:text-xl","uppercase","p-2","border","rounded-md"],[1,"flex","gap-3","justify-center","items-center"],["type","checkbox","name","include","formControlName","isSelected",1,"sm:h-8","sm:w-8","h-4","w-4",3,"click"],[1,"flex-1"],["type","number","formControlName","amount",1,"h-full","bg-slate-200","disabled:bg-slate-100","disabled:text-gray-500","rounded-md","border","p-4","text-xl","w-1/2","disabled:white"],[1,"flex","gap-3","p-2","flex-wrap"],[1,"sm:w-20","h-8","sm:h-12","border","border-green-500","rounded-lg","text-sm","sm:text-lg","bg-white","flex","justify-center","items-center","shadow-sm","shadow-green-700"],[1,"sm:w-20","h-8","sm:h-12","border","border-green-500","rounded-lg","text-sm","sm:text-lg","bg-white","flex","justify-center","items-center","shadow-sm","shadow-green-700",3,"click"],[1,"bg-white"]],template:function(r,s){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"span"),e.EFF(4,"Total: "),e.k0s(),e.EFF(5),e.nI1(6,"decimalpointpipe"),e.k0s(),e.j41(7,"div",3)(8,"div",4),e.nrm(9,"input",5),e.j41(10,"div")(11,"div",6),e.EFF(12,"Discount"),e.k0s(),e.nrm(13,"input",7),e.k0s()()(),e.j41(14,"div",8)(15,"div")(16,"div",6),e.EFF(17,"Balance"),e.k0s(),e.j41(18,"div",9),e.EFF(19),e.nI1(20,"decimalpointpipe"),e.k0s()()()(),e.j41(21,"form",10)(22,"div",11),e.Z7z(23,U,10,3,"div",12,e.fX1),e.k0s()(),e.j41(25,"div",13),e.nrm(26,"input",14),e.j41(27,"button",15),e.bIt("click",function(){return s.submitPayment()}),e.EFF(28," Confirm "),e.k0s()()()),2&r&&(e.R7$(5),e.SpI("",e.bMT(6,7,s.billTotal)," "),e.R7$(4),e.Y8G("formControl",s.shouldApplyDiscountControl),e.R7$(4),e.Y8G("formControl",s.discountAppliedControl),e.R7$(6),e.JRh(e.bMT(20,9,s.balance)),e.R7$(2),e.Y8G("formGroup",s.payForm),e.R7$(2),e.Dyx(s.modes.controls),e.R7$(3),e.Y8G("formControl",s.shouldPrintBillControl),e.R7$(),e.Y8G("disabled",!s.isFormValid))},dependencies:[p.X1,p.qT,p.me,p.Q0,p.Zm,p.BC,p.cb,p.l_,p.j4,p.JD,p.$R,p.v8,F.Yy],encapsulation:2}))}return o(),n})();function J(o,n){1&o&&(e.j41(0,"div",1),e.EFF(1," Loading.... "),e.k0s())}function z(o,n){1&o&&(e.j41(0,"div",35)(1,"span",36),e.EFF(2,"Loading..."),e.k0s()())}function Z(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",40),e.bIt("click",function(){d.eBV(i);const r=e.XpG(3),s=e.XpG(2);return d.Njj(s.makePayment(r))}),e.EFF(1," PAY "),e.k0s()}}function H(o,n){1&o&&(e.j41(0,"div",38),e.EFF(1," Printing... "),e.k0s())}function K(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",41),e.bIt("click",function(){d.eBV(i);const r=e.XpG(3),s=e.XpG(2);return d.Njj(s.printBill(r))}),e.EFF(1," PRINT "),e.k0s()}}function W(o,n){if(1&o&&(e.j41(0,"div"),e.nVh(1,Z,2,0,"div",37),e.nVh(2,H,2,0,"div",38),e.nI1(3,"async"),e.vZN(4,K,2,0,"div",39),e.k0s(),e.nrm(5,"hotel-orderapp-order-feature-add-more-item-button")),2&o){const i=e.XpG(2),t=e.XpG(),r=e.XpG();e.R7$(),e.vxM(r.canPayTheBill(i,t)?1:-1),e.R7$(),e.vxM(!0===e.bMT(3,2,r.selectPrintOrderSpinner$)?2:4)}}function Q(o,n){if(1&o&&(e.j41(0,"div"),e.nVh(1,z,3,0,"div",35),e.nI1(2,"async"),e.nI1(3,"async"),e.vZN(4,W,6,4),e.k0s()),2&o){const i=e.XpG(3);e.R7$(),e.vxM(!0===e.bMT(2,1,i.selectMakeBillSpinner$)||!0===e.bMT(3,3,i.selectPayTheOrderSpinner$)?1:4)}}function q(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",44),e.bIt("click",function(){d.eBV(i);const r=e.XpG(3),s=e.XpG(2);return d.Njj(s.makePayment(r))}),e.EFF(1," QUICK PAY "),e.k0s()}}function ee(o,n){if(1&o&&(e.j41(0,"div"),e.nVh(1,q,2,0,"div",43),e.k0s()),2&o){const i=e.XpG(4);e.R7$(),e.vxM(i.canMakeQwikPay(n)?1:-1)}}function te(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",45),e.bIt("click",function(){d.eBV(i);const r=e.XpG(2),s=e.XpG(2);return d.Njj(s.makeBillForOrder(r))}),e.EFF(1," MAKE BILL "),e.k0s()}}function re(o,n){if(1&o&&(e.nVh(0,ee,2,1,"div"),e.nI1(1,"async"),e.nVh(2,te,2,0,"div",42)),2&o){let i;const t=e.XpG(),r=e.XpG(2);e.vxM((i=e.bMT(1,2,r.selectSignedUser$))?0:-1,i),e.R7$(2),e.vxM("served"!==t.orderStatus?2:-1)}}function ie(o,n){if(1&o&&(e.j41(0,"button",18)(1,"div"),d.qSk(),e.j41(2,"svg",46)(3,"g"),e.nrm(4,"path",47),e.k0s()()()()),2&o){e.XpG();const i=e.sdS(28);e.Y8G("matMenuTriggerFor",i)}}function oe(o,n){if(1&o&&(e.j41(0,"div")(1,"div",21)(2,"div",48),e.EFF(3),e.k0s(),e.j41(4,"div",49)(5,"div"),e.EFF(6),e.k0s()(),e.j41(7,"div",50),e.EFF(8),e.k0s(),e.j41(9,"div",51),e.EFF(10),e.nI1(11,"decimalpointpipe"),e.k0s()()()),2&o){const i=n.$implicit,t=n.$index;e.R7$(3),e.JRh(t+1),e.R7$(3),e.JRh(i.name),e.R7$(2),e.JRh(i.count),e.R7$(2),e.SpI(" ",e.bMT(11,4,i.amount*i.count)," ")}}function ne(o,n){if(1&o&&(e.j41(0,"div",27),e.nrm(1,"div",28),e.j41(2,"div",29),e.EFF(3),e.k0s(),e.j41(4,"div",29),e.EFF(5),e.nI1(6,"decimalpointpipe"),e.k0s()()),2&o){const i=n.$implicit;e.R7$(3),e.JRh(i.taxName),e.R7$(2),e.SpI(" ",e.bMT(6,2,i.value)," ")}}function se(o,n){if(1&o&&(e.j41(0,"div",33)(1,"div"),e.EFF(2),e.k0s(),e.j41(3,"div"),e.EFF(4),e.k0s(),e.j41(5,"div"),e.EFF(6),e.nI1(7,"timesago"),e.k0s(),e.j41(8,"div"),e.EFF(9),e.k0s()()),2&o){const i=n.$implicit,t=e.XpG(3);e.Y8G("ngClass",t.kotBackgroundClass(i.status)),e.R7$(2),e.SpI("KOT NO: ",i.id),e.R7$(2),e.JRh(i.Kitchen.name),e.R7$(2),e.JRh(e.bMT(7,5,i.updatedAt)),e.R7$(3),e.JRh(i.status)}}function de(o,n){1&o&&(e.j41(0,"div",34),e.nrm(1,"lib-payment-mode-list"),e.k0s())}function le(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",2)(1,"div",4)(2,"div",5)(3,"div",6),e.EFF(4),e.k0s(),e.j41(5,"div",7),e.EFF(6),e.nI1(7,"timesago"),e.k0s(),e.nrm(8,"div",8),e.j41(9,"div",9),e.EFF(10),e.nI1(11,"decimalpointpipe"),e.k0s()(),e.j41(12,"div",10)(13,"div",8)(14,"div",11),e.EFF(15," Type: "),e.j41(16,"span",12),e.EFF(17),e.k0s()(),e.j41(18,"div",13),e.EFF(19),e.k0s()(),e.j41(20,"div",14)(21,"div",15),e.nrm(22,"hotel-orderapp-order-feature-add-more-item-button",16),e.k0s(),e.nVh(23,Q,5,5,"div")(24,re,3,4),e.j41(25,"div",17),e.nVh(26,ie,5,1,"button",18),e.j41(27,"mat-menu",null,0)(29,"button",19),e.bIt("click",function(){const r=d.eBV(i),s=e.XpG(2);return d.Njj(s.cancelOrderClicked(r))}),e.j41(30,"span"),e.EFF(31,"Cancel Order"),e.k0s()()()()()(),e.j41(32,"div",20)(33,"div",21)(34,"div",22),e.EFF(35,"SNO:"),e.k0s(),e.j41(36,"div",23),e.EFF(37,"Item Name:"),e.k0s(),e.j41(38,"div",24),e.EFF(39,"Qty:"),e.k0s(),e.j41(40,"div",25),e.EFF(41,"Tot:"),e.k0s()(),e.Z7z(42,oe,12,6,"div",null,e.fX1),e.nrm(44,"div",26),e.j41(45,"div",27),e.nrm(46,"div",28),e.j41(47,"div",29),e.EFF(48,"Bill Total"),e.k0s(),e.j41(49,"div",29),e.EFF(50),e.nI1(51,"decimalpointpipe"),e.k0s()(),e.Z7z(52,ne,7,4,"div",27,e.fX1),e.j41(54,"div",27),e.nrm(55,"div",28),e.j41(56,"div",29),e.EFF(57,"Net Total"),e.k0s(),e.j41(58,"div",29),e.EFF(59),e.nI1(60,"decimalpointpipe"),e.k0s()()()(),e.j41(61,"div",30)(62,"mat-expansion-panel")(63,"mat-expansion-panel-header")(64,"mat-panel-title"),e.EFF(65,"Kitchen Orders"),e.k0s()(),e.j41(66,"div",31)(67,"div",32),e.Z7z(68,se,10,7,"div",33,e.fX1),e.k0s()()()(),e.nVh(70,de,2,0,"div",34),e.k0s()}if(2&o){const i=n,t=e.XpG(),r=e.XpG();e.R7$(4),e.SpI(" Order - ",i.orderNumber," "),e.R7$(2),e.SpI(" ",e.bMT(7,11,i.createdAt)," "),e.R7$(4),e.SpI(" ",e.bMT(11,13,i.totalAmount)," "),e.R7$(7),e.JRh(i.orderType),e.R7$(2),e.SpI(" Customer: ",r.displayCustomerOrTableName(i)," "),e.R7$(3),e.Y8G("order",i),e.R7$(),e.vxM("served"===i.orderStatus?23:24),e.R7$(3),e.vxM(t.isCashier?26:-1),e.R7$(16),e.Dyx(i.orderItems),e.R7$(8),e.SpI(" ",e.bMT(51,15,i.totalAmount)," "),e.R7$(2),e.Dyx(i.appliedTaxes),e.R7$(7),e.SpI(" ",e.bMT(60,17,i.taxedTotal)," "),e.R7$(9),e.Dyx(i.kot),e.R7$(2),e.vxM(r.canMakeQwikPay(t)?70:-1)}}function ae(o,n){1&o&&(e.j41(0,"div",3),e.EFF(1," No order selected, Please select an order to view "),e.k0s())}function ce(o,n){if(1&o&&(e.j41(0,"div"),e.nVh(1,J,2,0,"div",1),e.nI1(2,"async"),e.nVh(3,le,71,19,"div",2),e.nI1(4,"async"),e.vZN(5,ae,2,0,"div",3),e.k0s()),2&o){let i;const t=e.XpG();e.R7$(),e.vxM(e.bMT(2,2,t.selectOrderDetailsLoadSpinner$)?1:-1),e.R7$(2),e.vxM((i=e.bMT(4,4,t.selectOrderDetailsOfSelectedOrder$))?3:5,i)}}let E=(()=>{var o;class n{constructor(t,r){this.store=t,this.dialog=r,this.selectOrderDetailsLoadSpinner$=this.store.select(a.selectLoadOrderDetailSpinner),this.selectOrderDetailsOfSelectedOrder$=this.store.select(a.selectOrderDetailsOfSelectedOrder),this.selectMakeBillSpinner$=this.store.select(a.selectMakeBillSpinner),this.selectPrintOrderSpinner$=this.store.select(a.selectPrintOrderSpinner),this.selectPayTheOrderSpinner$=this.store.select(a.selectPayTheOrderSpinner),this.selectSignedUser$=this.store.select(g.Y6)}makeBillForOrder(t){this.store.dispatch((0,a.makeBillForOrder)({orderId:t.id})),this.dialog.open(V.r,{width:"90vw"})}makePayment(t){this.openDialog().afterClosed().subscribe(r=>{this.store.dispatch((0,a.payTheOrder)("yes"===r?{orderId:t.id,shouldPrint:!0,paymentDetails:{paidAmount:t.taxedTotal??t.totalAmount,discount:0,balance:0,mode:"cash"}}:{orderId:t.id,shouldPrint:!1,paymentDetails:{paidAmount:t.taxedTotal??t.totalAmount,discount:0,balance:0,mode:"cash"}}))})}creditSettleOrder(t){confirm("CREDIT settle the order")&&this.openDialog().afterClosed().subscribe(r=>{this.store.dispatch((0,a.creditTheOrder)("yes"===r?{orderId:t.id,shouldPrint:!0}:{orderId:t.id,shouldPrint:!1}))})}printBill(t){this.store.dispatch((0,a.printBillForOrder)({orderId:t.id}))}canPayTheBill(t,r){return"paid"!==t.paymentStatus&&r.isCashier}canMakeQwikPay(t){return t.isCashier}openDialog(){return this.dialog.open(S.D,{data:{title:"Print Bill",content:"Click Print to print Bill",okBtnText:"PRINT"},disableClose:!0})}creditPayClicked(t){return"helo"}cancelOrderClicked(t){this.dialog.open(G.L)}kotBackgroundClass(t){let r="bg-green-200";switch(t){case m.xt.READY:r="bg-green-200";break;case m.xt.INPROGRESS:r="bg-orange-200"}return r}displayCustomerOrTableName(t){const r=t.customer;return`${r?.firstName} - ${r?.lastName}`}static#e=o=()=>(this.\u0275fac=function(r){return new(r||n)(e.rXU(v.il),e.rXU(_.h))},this.\u0275cmp=e.VBU({type:n,selectors:[["hotel-orderapp-order-feature-order-detail"]],decls:2,vars:3,consts:[["menu","matMenu"],[1,"h-screen","flex","items-center","justify-center"],[1,"bg-gray-100","p-2","w-full"],[1,"h-full","flex","justify-center","items-center"],[1,"rounded-md","bg-white","p-2"],[1,"flex","w-full","flex-row","items-stretch"],[1,"font-bold","capitalize"],[1,"ml-2","border-l-2","pl-2","font-light"],[1,"flex-grow"],[1,"font-semibold"],[1,"flex","flex-row"],[1,"font-semibod"],[1,"font-light"],[1,"font-thin"],[1,"flex","flex-col","sm:flex-row","gap-4"],[1,""],[3,"order"],[1,"text-right"],["mat-icon-button","",1,"",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],[1,"mt-2","border","border-gray-400","p-2","max-w-md","max-h-sm","overflow-y-auto"],[1,"grid","grid-cols-12","gap-2","py-1"],[1,"col-span-1","text-xs","font-bold"],[1,"col-span-6","text-xs","font-bold"],[1,"col-span-3","text-xs","font-bold"],[1,"col-span-2","text-xs","font-bold"],[1,"my-2","h-[1px]","w-full","bg-gray-600"],[1,"grid","grid-cols-4","pt-2"],[1,"col-span-2"],[1,"col-span-1"],[1,"mt-3"],[1,"bg-white","rounded-lg"],[1,"space-y-1"],[1,"flex","gap-3","p-1","justify-between","font-semibold",3,"ngClass"],[1,"mt-2"],["role","status"],[1,"sr-only"],[1,"inline-block","h-7","rounded-md","bg-purple-900","p-1","text-right","text-sm","text-white","cursor-pointer"],[1,"inline-block","h-7","rounded-md","bg-gray-400","p-1","text-right","text-sm","text-white","cursor-pointer"],[1,"inline-block","h-7","rounded-md","bg-green-700","ml-2","p-1","px-2","text-right","text-sm","text-white","cursor-pointer"],[1,"inline-block","h-7","rounded-md","bg-purple-900","p-1","text-right","text-sm","text-white","cursor-pointer",3,"click"],[1,"inline-block","h-7","rounded-md","bg-green-700","ml-2","p-1","px-2","text-right","text-sm","text-white","cursor-pointer",3,"click"],[1,"inline-block","h-7","rounded-md","bg-blue-700","p-1","text-right","text-sm","text-white","cursor-pointer"],[1,"h-7","rounded-md","bg-blue-700","p-1","px-2","text-center","text-sm","text-white","cursor-pointer"],[1,"h-7","rounded-md","bg-blue-700","p-1","px-2","text-center","text-sm","text-white","cursor-pointer",3,"click"],[1,"inline-block","h-7","rounded-md","bg-blue-700","p-1","text-right","text-sm","text-white","cursor-pointer",3,"click"],["version","1.1","id","Layer_1","x","0px","y","0px","width","13px","height","20px","viewBox","0 0 29.957 122.88","enable-background","new 0 0 29.957 122.88",0,"xml","space","preserve","fill","#000"],["fill-rule","evenodd","clip-rule","evenodd","d","M14.978,0c8.27,0,14.979,6.708,14.979,14.979c0,8.27-6.709,14.976-14.979,14.976 C6.708,29.954,0,23.249,0,14.979C0,6.708,6.708,0,14.978,0L14.978,0z M14.978,92.926c8.27,0,14.979,6.708,14.979,14.979 s-6.709,14.976-14.979,14.976C6.708,122.88,0,116.175,0,107.904S6.708,92.926,14.978,92.926L14.978,92.926z M14.978,46.463 c8.27,0,14.979,6.708,14.979,14.979s-6.709,14.978-14.979,14.978C6.708,76.419,0,69.712,0,61.441S6.708,46.463,14.978,46.463 L14.978,46.463z"],[1,"col-span-1","text-xs"],[1,"col-span-6","text-xs"],[1,"col-span-3","text-xs"],[1,"col-span-2","text-xs"]],template:function(r,s){if(1&r&&(e.nVh(0,ce,6,6,"div"),e.nI1(1,"async")),2&r){let c;e.vxM((c=e.bMT(1,1,s.selectSignedUser$))?0:-1,c)}},dependencies:[u.MD,u.YU,_.l,R,j.m_,h.Cn,h.kk,h.fb,h.Cp,x.MY,x.GK,x.Z2,x.WN,Y,u.Jj,F.Ec,F.Yy],encapsulation:2}))}return o(),n})();var M=l(491),D=l(1537);const pe=o=>({temp:o}),b=o=>({"bg-red-600 text-white":o}),me=o=>({"bg-green-100":o});function ue(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",9),e.bIt("click",function(){const r=d.eBV(i).$implicit,s=e.XpG(3);return d.Njj(s.setFloorFilter(r.name))}),e.j41(1,"div",10),e.EFF(2),e.k0s()()}if(2&o){const i=n.$implicit,t=e.XpG(3);e.R7$(),e.Y8G("ngClass",e.eq3(2,b,i.name===t.selectedFilterText)),e.R7$(),e.SpI(" ",i.name," ")}}function _e(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",15),e.bIt("click",function(){const r=d.eBV(i).$implicit,s=e.XpG(3);return d.Njj(s.setUserNameFilter(r))}),e.j41(1,"div",10)(2,"span",16),e.EFF(3),e.k0s(),e.EFF(4," |"),e.j41(5,"span",17),e.EFF(6),e.k0s()()()}if(2&o){const i=n.$implicit,t=e.XpG(3);e.R7$(),e.Y8G("ngClass",e.eq3(3,b,t.selectedFilterText==="filterForCreatedUser$"+i.name)),e.R7$(2),e.JRh(i.name),e.R7$(3),e.JRh(i.count)}}function he(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",18),e.bIt("click",function(){d.eBV(i);const r=e.XpG(3);return d.Njj(r.setFloorFilter(""))}),e.EFF(1," Clear "),e.k0s()}}function fe(o,n){1&o&&(e.j41(0,"div",14),e.EFF(1,"All orders are settled."),e.k0s())}function Ce(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",33),e.bIt("click",function(){d.eBV(i);const r=e.XpG().$implicit,s=e.XpG(3);return d.Njj(s.openOrderDetailEdit(r))}),e.EFF(1," EDIT "),e.k0s()}}function Fe(o,n){if(1&o){const i=e.RV6();e.j41(0,"div")(1,"div",19)(2,"div",20)(3,"div",21),e.EFF(4),e.k0s(),e.j41(5,"div",22),e.EFF(6),e.nI1(7,"timesago"),e.k0s(),e.nrm(8,"div",1),e.k0s(),e.j41(9,"div",23)(10,"div",1)(11,"div",24)(12,"span",25),e.EFF(13),e.k0s()(),e.j41(14,"div",26),e.EFF(15),e.k0s()(),e.j41(16,"div",27),e.nrm(17,"hotel-orderapp-order-feature-add-more-item-button",28),e.k0s(),e.nVh(18,Ce,2,0,"div",29),e.j41(19,"div",30),e.bIt("click",function(){const r=d.eBV(i).$implicit,s=e.XpG(3);return d.Njj(s.loadOrderDetail(r))}),e.EFF(20," VIEW "),e.k0s(),e.j41(21,"div",31),e.bIt("click",function(){const r=d.eBV(i).$implicit,s=e.XpG(3);return d.Njj(s.openOrderDetail(r))}),e.EFF(22," VIEW "),e.k0s()(),e.j41(23,"div",32),e.EFF(24),e.k0s()()()}if(2&o){const i=n.$implicit,t=e.XpG(2),r=e.XpG();e.R7$(),e.Y8G("ngClass",e.eq3(10,me,i.id===(t.temp?t.temp.id:-1))),e.R7$(3),e.SpI("Order ",i.orderNumber),e.R7$(2),e.SpI(" ",e.bMT(7,8,i.createdAt)," "),e.R7$(7),e.JRh("table"===i.orderType?"Dine In":i.orderType),e.R7$(2),e.JRh(r.displayCustomerOrTableName(i)),e.R7$(2),e.Y8G("order",i),e.R7$(),e.vxM(r.canEditOrder(i)?18:-1),e.R7$(6),e.JRh(i.user.name)}}function ve(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",6)(1,"div",7),e.Z7z(2,ue,3,4,"div",8,e.fX1),e.nI1(4,"async"),e.j41(5,"div",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG(2);return d.Njj(r.setFloorFilter("filterForTakeAwayAsFloorName"))}),e.j41(6,"div",10),e.EFF(7," Take Away "),e.k0s()(),e.j41(8,"div",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG(2);return d.Njj(r.setFloorFilter("filterForHomedeliveryAsFloorName"))}),e.j41(9,"div",10),e.EFF(10," Homedelivery "),e.k0s()(),e.Z7z(11,_e,7,5,"div",11,e.fX1),e.nI1(13,"async"),e.nrm(14,"div",12),e.nVh(15,he,2,0,"div",13),e.k0s(),e.nVh(16,fe,2,0,"div",14),e.Z7z(17,Fe,25,12,"div",null,e.fX1),e.k0s()}if(2&o){const i=n,t=e.XpG(2);e.R7$(2),e.Dyx(e.bMT(4,4,t.selectFloors$)),e.R7$(4),e.Y8G("ngClass",e.eq3(8,b,"filterForTakeAwayAsFloorName"===t.selectedFilterText)),e.R7$(3),e.Y8G("ngClass",e.eq3(10,b,"filterForHomedeliveryAsFloorName"===t.selectedFilterText)),e.R7$(2),e.Dyx(e.bMT(13,6,t.selectorderCreatedUserNames$)),e.R7$(4),e.vxM(t.selectedFilterText?15:-1),e.R7$(),e.vxM(i.length<1?16:-1),e.R7$(),e.Dyx(i)}}function Oe(o,n){1&o&&(e.j41(0,"div"),e.EFF(1,"No Orders"),e.k0s())}function xe(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",0)(1,"div",1),e.EFF(2,"Non Settled Orders"),e.k0s(),e.j41(3,"button",2),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.loadNonSettledOrders())}),e.EFF(4," REFRESH "),e.k0s(),e.j41(5,"span",3),e.nrm(6,"span",4)(7,"span",5),e.k0s()(),e.nVh(8,ve,19,12,"div",6),e.nI1(9,"async"),e.vZN(10,Oe,2,0,"div")}if(2&o){let i;const t=e.XpG();e.R7$(8),e.vxM((i=e.bMT(9,1,t.selectFilteredRecentOrders$))?8:10,i)}}let ge=(()=>{var o;class n{constructor(t,r){this.store=t,this.dialog=r,this.selectRecentOrders$=this.store.select(a.selectRecentOrders),this.selectFilteredRecentOrders$=this.store.select(a.selectFilteredRecentOrders),this.selectorderCreatedUserNames$=this.store.select(a.selectorderCreatedUserNames),this.selectedFilterText="",this.selectFloors$=this.store.select(D.AA),this.selectedOrderDetailsOfSelectedOrder$=this.store.select(a.selectOrderDetailsOfSelectedOrder),this.store.dispatch((0,a.setFloorFilterForOrders)({filterTerm:""})),this.store.dispatch((0,D.M2)())}loadOrderDetail(t){this.dialog.closeAll(),this.store.dispatch((0,a.loadOrderDetails)({orderId:t.id}))}openOrderDetail(t){this.loadOrderDetail(t),this.dialog.open(E,{height:"90vh",width:"90vw"})}openOrderDetailEdit(t){this.loadOrderDetail(t),this.store.dispatch((0,k.hc)({user:{firstName:t.customer?.firstName??"firstName",lastName:t.customer?.lastName,userType:m.ut.ADMIN},tableId:1,customerId:t.customerId,existingOrderId:t.id})),this.dialog.open(M.eW,{})}loadNonSettledOrders(){this.store.dispatch((0,a.loadRecentOrders)()),this.store.dispatch((0,a.setFloorFilterForOrders)({filterTerm:""})),this.selectedFilterText=""}displayCustomerOrTableName(t){const r=t.customer;return`${r?.firstName} - ${r?.lastName}`}setFloorFilter(t){this.selectedFilterText=t,this.store.dispatch((0,a.setFloorFilterForOrders)({filterTerm:t}))}setUserNameFilter(t){this.setFloorFilter(`filterForCreatedUser$${t.name}`)}canEditOrder(t){return t.orderStatus!=m.Re.DELIVERED&&t.orderStatus!=m.Re.SERVED}static#e=o=()=>(this.\u0275fac=function(r){return new(r||n)(e.rXU(v.il),e.rXU(_.h))},this.\u0275cmp=e.VBU({type:n,selectors:[["hotel-orderapp-order-feature-order-list"]],decls:2,vars:5,consts:[[1,"font-bold","px-3","pt-2","w-full","bg-gray-100","flex"],[1,"flex-grow"],[1,"px-2","bg-white","py-1","border","text-center","font-light","rounded-md","cursor-pointer",3,"click"],[1,"relative","flex","h-3","w-3"],[1,"animate-ping","absolute","inline-flex","h-full","w-full","rounded-full","bg-sky-400","opacity-75"],[1,"relative","inline-flex","rounded-full","h-3","w-3","bg-sky-500"],[1,"py-2","bg-gray-100","p-2","h-full"],[1,"p-2","flex","flex-wrap","gap-3","bg-white","mb-2","max-h-24","overflow-y-scroll"],[1,"bg-blue-200","cursor-pointer"],[1,"bg-blue-200","cursor-pointer",3,"click"],[1,"px-2","py-1","text-center",3,"ngClass"],[1,"bg-slate-300","cursor-pointer"],[1,""],[1,"px-2","py-1","text-center","bg-gray-700","text-white","rounded-full","cursor-pointer"],[1,"w-52"],[1,"bg-slate-300","cursor-pointer",3,"click"],[1,"mr-2"],[1,"ml-1","font-semibold"],[1,"px-2","py-1","text-center","bg-gray-700","text-white","rounded-full","cursor-pointer",3,"click"],[1,"rounded-md","bg-white","p-2","mb-2",3,"ngClass"],[1,"flex","w-full","flex-row","items-stretch"],[1,"font-bold","capitalize"],[1,"ml-2","border-l-2","pl-2","font-light"],[1,"flex","flex-row"],[1,"font-semibod"],[1,"font-semibold"],[1,"font-thin"],[1,"px-2"],[3,"order"],[1,"h-7","rounded-md","mr-2","bg-red-700","p-1","px-2","text-right","text-sm","text-white","hover:bg-red-500","cursor-pointer"],[1,"h-7","hidden","sm:inline-block","rounded-md","bg-green-700","p-1","px-2","text-right","text-sm","text-white","hover:bg-green-500","cursor-pointer",3,"click"],[1,"inline-block","h-7","sm:hidden","rounded-md","bg-green-700","p-1","px-2","text-right","text-sm","text-white","hover:bg-green-500","cursor-pointer",3,"click"],[1,"font-bold"],[1,"h-7","rounded-md","mr-2","bg-red-700","p-1","px-2","text-right","text-sm","text-white","hover:bg-red-500","cursor-pointer",3,"click"]],template:function(r,s){if(1&r&&(e.nVh(0,xe,11,3),e.nI1(1,"async")),2&r){let c;e.vxM((c=e.eq3(3,pe,e.bMT(1,1,s.selectedOrderDetailsOfSelectedOrder$)))?0:-1,c)}},dependencies:[u.MD,u.YU,_.l,R,u.Jj,F.Ec],encapsulation:2}))}return o(),n})();var be=l(8822),ke=l(3504),N=l(5911),Te=l(8132);function ye(o,n){if(1&o){const i=e.RV6();e.j41(0,"button",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG(2);return d.Njj(r.goToHomeDelivery())}),e.j41(1,"span"),e.EFF(2,"Home Delivery"),e.k0s()()}}function je(o,n){if(1&o){const i=e.RV6();e.j41(0,"div",1)(1,"mat-toolbar",2)(2,"span",3),e.EFF(3,"Orders"),e.k0s(),e.nrm(4,"span",4),e.j41(5,"button",5),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.goToHomeOrderPage())}),e.EFF(6," TAKE NEW "),e.k0s(),e.j41(7,"button",6)(8,"div"),d.qSk(),e.j41(9,"svg",7)(10,"g"),e.nrm(11,"path",8),e.k0s()()()(),d.joV(),e.j41(12,"mat-menu",null,0)(14,"button",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.goToShellPage())}),e.j41(15,"span"),e.EFF(16,"Home"),e.k0s()(),e.j41(17,"button",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.goToHomeOrderPage())}),e.j41(18,"span"),e.EFF(19,"New Order"),e.k0s()(),e.nVh(20,ye,3,0,"button",10),e.j41(21,"button",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.goToOrderHistory())}),e.j41(22,"span"),e.EFF(23,"My Orders"),e.k0s()(),e.j41(24,"button",9),e.bIt("click",function(){d.eBV(i);const r=e.XpG();return d.Njj(r.logout())}),e.j41(25,"span"),e.EFF(26,"Logout"),e.k0s()()()(),e.j41(27,"div",11)(28,"div",12),e.nrm(29,"hotel-orderapp-order-feature-order-list"),e.k0s(),e.j41(30,"div",13),e.nrm(31,"hotel-orderapp-order-feature-order-detail"),e.k0s()()()}if(2&o){const i=e.sdS(13),t=e.XpG();e.R7$(7),e.Y8G("matMenuTriggerFor",i),e.R7$(13),e.vxM(t.canAccessHomeDeliveryPage(n)?20:-1)}}let w=(()=>{var o;class n{constructor(t,r,s){this.dialog=t,this.store=r,this.router=s,this.selectSignedUser$=this.store.select(g.Y6),this.store.dispatch((0,a.loadRecentOrders)())}ngOnDestroy(){this.store.dispatch((0,a.clearTheOrderDetails)())}canAccessHomeDeliveryPage(t){return t.isHomeDeliveryUser||t.isCashier}logout(){this.store.dispatch((0,g.ri)())}goToShellPage(){this.router.navigate(["shell"])}goToHomeOrderPage(){this.router.navigate(["shell/home"])}goToHomeDelivery(){this.router.navigate(["shell/homedelivery"])}goToOrderHistory(){this.router.navigate(["shell/history"])}static#e=o=()=>(this.\u0275fac=function(r){return new(r||n)(e.rXU(_.h),e.rXU(v.il),e.rXU($.Ix))},this.\u0275cmp=e.VBU({type:n,selectors:[["hotel-orderapp-order-feature-page"]],decls:2,vars:3,consts:[["menu","matMenu"],[1,"h-screen"],["color","primary",1,"flex"],[1,"pl-2"],[1,"flex-grow"],[1,"px-2","py-1","bg-pink-400","font-bold","rounded-md","text-base","mr-3",3,"click"],["mat-icon-button","","aria-label","Example icon-button with a menu",3,"matMenuTriggerFor"],["version","1.1","id","Layer_1","x","0px","y","0px","width","13px","height","20px","viewBox","0 0 29.957 122.88","enable-background","new 0 0 29.957 122.88",0,"xml","space","preserve","fill","#fefefe"],["fill-rule","evenodd","clip-rule","evenodd","d","M14.978,0c8.27,0,14.979,6.708,14.979,14.979c0,8.27-6.709,14.976-14.979,14.976 C6.708,29.954,0,23.249,0,14.979C0,6.708,6.708,0,14.978,0L14.978,0z M14.978,92.926c8.27,0,14.979,6.708,14.979,14.979 s-6.709,14.976-14.979,14.976C6.708,122.88,0,116.175,0,107.904S6.708,92.926,14.978,92.926L14.978,92.926z M14.978,46.463 c8.27,0,14.979,6.708,14.979,14.979s-6.709,14.978-14.979,14.978C6.708,76.419,0,69.712,0,61.441S6.708,46.463,14.978,46.463 L14.978,46.463z"],["mat-menu-item","",3,"click"],["mat-menu-item",""],[1,"sm:grid","sm:gap-2","sm:grid-cols-5","mx-auto","h-full"],[1,"sm:col-span-2","overflow-y-auto"],[1,"sm:col-span-3","sm:block","hidden"]],template:function(r,s){if(1&r&&(e.nVh(0,je,32,2,"div",1),e.nI1(1,"async")),2&r){let c;e.vxM((c=e.bMT(1,1,s.selectSignedUser$))?0:-1,c)}},dependencies:[u.MD,Te.iI,_.l,be._T,ke.vg,N.s5,N.KQ,j.m_,h.Cn,h.kk,h.fb,h.Cp,ge,E,u.Jj],encapsulation:2}))}return o(),n})();const $e=[{path:"",component:w,providers:[]},{path:"edit",component:M.eW}]}}]);